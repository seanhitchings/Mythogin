/* ==========================================================================
   components/accordion.css â€” Shared accordion component
   Purpose:
   - Reusable accordion for long sections (Topics, Story pages, etc.)
   - ZERO coupling to .section-card / card.css
   - Opt-in by class: .accordion (and optional modifiers)
   Uses:
   - Native <details>/<summary> for accessibility + no JS requirement
   ========================================================================== */


/* ==========================================================================
   Scoped knobs (DO NOT put component knobs in :root)
   ========================================================================== */

.accordion{
  /* accordion knobs */
  --acc-radius: calc(var(--radius) + 2px);
  --acc-border: rgba(255,255,255,.12);
  --acc-bg: rgba(17,21,27,.78);
  --acc-bg-hover: rgba(215,188,161,.06);
  --acc-title: rgba(232,237,245,.94);
  --acc-text: rgba(170,180,195,.92);
  --acc-pad-x: 16px;
  --acc-pad-y: 14px;
  --acc-gap: 12px;
}


/* --------------------------------------------------------------------------
   1) Accordion stack
   -------------------------------------------------------------------------- */

.accordion{
  display: grid;
  gap: var(--acc-gap);

  /* shrink/overflow safety */
  min-width: 0;
}

/* Optional: tighter stack */
.accordion--tight{
  --acc-gap: 10px;
  --acc-pad-y: 12px;
}

/* Optional: extra separation from surrounding content */
.accordion--spaced{
  margin-top: 18px;
}


/* --------------------------------------------------------------------------
   2) Item shell
   Markup: <details class="accordion-item">
   -------------------------------------------------------------------------- */

.accordion .accordion-item{
  border: 1px solid var(--acc-border);
  border-radius: var(--acc-radius);
  background: var(--acc-bg);
  overflow: hidden;
  box-shadow: var(--shadow);

  /* critical: padding stays inside width + allow shrinking */
  box-sizing: border-box;
  min-width: 0;
  max-width: 100%;
}

/* Open state can get a slightly stronger border */
.accordion .accordion-item[open]{
  border-color: rgba(215,188,161,.30);
}


/* --------------------------------------------------------------------------
   3) Summary row (click target)
   Markup: <summary class="accordion-summary">...</summary>
   -------------------------------------------------------------------------- */

.accordion .accordion-summary{
  list-style: none; /* remove default marker spacing in some browsers */
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;

  padding: var(--acc-pad-y) var(--acc-pad-x);
  cursor: pointer;
  user-select: none;

  color: var(--acc-title);

  /* critical: allow flex children to shrink */
  min-width: 0;
  box-sizing: border-box;
}

/* Remove default disclosure triangle (we draw our own caret) */
.accordion .accordion-summary::-webkit-details-marker{ display: none; }
.accordion .accordion-summary::marker{ content: ""; }

/* Hover / focus */
.accordion .accordion-summary:hover{
  background: var(--acc-bg-hover);
}

.accordion .accordion-summary:focus-visible{
  outline: none;
  box-shadow: 0 0 0 2px rgba(215,188,161,.35) inset;
}


/* --------------------------------------------------------------------------
   Title/subtitle block (shrink + wrap-safe)
   -------------------------------------------------------------------------- */

/* Whatever wraps your title/sub text should be allowed to shrink.
   If your markup uses a wrapper, give it class="accordion-text".
   If not, this still helps because h* and p get min-width:0 below. */
.accordion .accordion-text{
  flex: 1 1 auto;
  min-width: 0; /* critical */
}

/* Title text */
.accordion .accordion-title{
  margin: 0;
  font-size: 15px;
  letter-spacing: .01em;
  color: var(--acc-title);

  /* critical: prevent long strings forcing layout wider */
  min-width: 0;
  overflow-wrap: anywhere;
  word-break: break-word;
  hyphens: auto;
}

/* Optional subtitle (small grey line under the title) */
.accordion .accordion-sub{
  margin: 4px 0 0;
  font-size: 13px;
  color: rgba(170,180,195,.85);

  min-width: 0;
  overflow-wrap: anywhere;
  word-break: break-word;
  hyphens: auto;
}


/* --------------------------------------------------------------------------
   4) Caret icon (rotates when open)
   -------------------------------------------------------------------------- */

.accordion .accordion-caret{
  flex: 0 0 auto;
  width: 28px;
  height: 28px;
  border-radius: 10px;
  border: 1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.04);

  display: inline-flex;
  align-items: center;
  justify-content: center;

  transition: transform .15s ease, border-color .15s ease, background .15s ease;
  color: rgba(232,237,245,.85);
}

.accordion .accordion-item[open] .accordion-caret{
  transform: rotate(180deg);
  border-color: rgba(215,188,161,.35);
  background: rgba(215,188,161,.08);
}


/* --------------------------------------------------------------------------
   5) Panel content
   Markup: <div class="accordion-panel">...</div>
   -------------------------------------------------------------------------- */

.accordion .accordion-panel{
  padding: 0 var(--acc-pad-x) var(--acc-pad-x);
  color: var(--acc-text);
  line-height: 1.6;

  box-sizing: border-box;
  min-width: 0;
}

/* If you want the panel to have a subtle top rule */
.accordion .accordion-panel--ruled{
  padding-top: 12px;
  border-top: 1px solid rgba(255,255,255,.08);
}

/* Nice spacing for typical content */
.accordion .accordion-panel > :first-child{ margin-top: 10px; }
.accordion .accordion-panel > :last-child{ margin-bottom: 0; }


/* --------------------------------------------------------------------------
   6) Optional: nested TOC-like links inside panels
   -------------------------------------------------------------------------- */

.accordion .accordion-panel a{
  color: rgba(232,237,245,.9);
  text-decoration: none;
  border-bottom: 1px solid rgba(255,255,255,.12);

  /* also wrap-safe if links are long */
  overflow-wrap: anywhere;
  word-break: break-word;
}

.accordion .accordion-panel a:hover{
  border-bottom-color: rgba(215,188,161,.35);
}
